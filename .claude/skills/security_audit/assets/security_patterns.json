{
  "sast_patterns": {
    "injection": {
      "patterns": [
        "cursor\\.execute\\([^)]*[\\+\\%]\\s*.*\\)",
        "os\\.system\\([^)]*[\\+\\%]\\s*.*\\)",
        "eval\\([^)]*[\\+\\%]\\s*.*\\)",
        "exec\\([^)]*[\\+\\%]\\s*.*\\)",
        "subprocess\\.(call|run|Popen)\\([^)]*[\\+\\%]\\s*.*\\)",
        "sql\\s*=\\s*.*[\\+\\%].*",
        "query\\s*=\\s*.*\\+.*"
      ],
      "severity": "critical",
      "description": "Potential code/command injection vulnerability",
      "cwe": "CWE-94",
      "owasp": "A03:2021-Injection"
    },
    "xss": {
      "patterns": [
        "return.*render.*[^<]*\\{[^}]*\\}[^>]*",
        "html\\s*=\\s*.*\\+.*\\+.*",
        "dangerouslySetInnerHTML",
        "innerHTML\\s*=\\s*",
        "document\\.write\\(",
        "eval\\(.*innerHTML.*\\)"
      ],
      "severity": "high",
      "description": "Potential cross-site scripting vulnerability",
      "cwe": "CWE-79",
      "owasp": "A07:2021-Identification and Authentication Failures"
    },
    "hardcoded_secrets": {
      "patterns": [
        "password\\s*[:=]\\s*[\"\\'][^\"\\']+[\"\\']",
        "api_key\\s*[:=]\\s*[\"\\'][^\"\\']+[\"\\']",
        "secret\\s*[:=]\\s*[\"\\'][^\"\\']+[\"\\']",
        "token\\s*[:=]\\s*[\"\\'][^\"\\']+[\"\\']",
        "AWS_ACCESS_KEY_ID.*=.*[\"\\'][A-Z0-9]+[\"\\']",
        "AWS_SECRET_ACCESS_KEY.*=.*[\"\\'][A-Za-z0-9/+=]+[\"\\']",
        "SECRET_KEY.*=.*[\"\\'][^\"\\']+[\"\\']",
        "DATABASE_URL.*=.*[\"\\'][^\"\\']+[\"\\']"
      ],
      "severity": "high",
      "description": "Hardcoded secret detected",
      "cwe": "CWE-798",
      "owasp": "A07:2021-Identification and Authentication Failures"
    },
    "path_traversal": {
      "patterns": [
        "open\\([^)]*[\\+\\%]\\s*.*\\)",
        "os\\.path\\.join\\([^)]*[\\+\\%]\\s*.*\\)",
        "file\\s*=\\s*request\\.args\\[",
        "filepath\\s*=\\s*.*\\+.*",
        "send_file\\(.*\\+.*\\)"
      ],
      "severity": "high",
      "description": "Potential path traversal vulnerability",
      "cwe": "CWE-22",
      "owasp": "A01:2021-Broken Access Control"
    },
    "csrf": {
      "patterns": [
        "csrf_token\\s*=\\s*False",
        "WTF_CSRF_ENABLED\\s*=\\s*False",
        "csrf_protection\\s*=\\s*False",
        "without CSRF protection"
      ],
      "severity": "medium",
      "description": "Missing CSRF protection",
      "cwe": "CWE-352",
      "owasp": "A01:2021-Broken Access Control"
    }
  },
  "config_issues": {
    "debug_enabled": {
      "patterns": [
        "DEBUG\\s*[:=]\\s*True",
        "debug\\s*[:=]\\s*true",
        "app\\.config\\[.DEBUG.\\]\\s*=\\s*True",
        "--debug",
        "--dev",
        "NODE_ENV\\s*=\\s*.development."
      ],
      "severity": "medium",
      "description": "Debug mode enabled in production",
      "cwe": "CWE-489",
      "owasp": "A05:2021-Security Misconfiguration"
    },
    "cors_misconfig": {
      "patterns": [
        "Access-Control-Allow-Origin\\s*[:=]\\s*[\"\\']*\\*[\"\\']",
        "allow_origins=\\[\"\\*\"\\]",
        "cors.*allow_origins.*\\*",
        "Access-Control-Allow-Credentials\\s*[:=]\\s*true"
      ],
      "severity": "medium",
      "description": "CORS configured to allow all origins",
      "cwe": "CWE-346",
      "owasp": "A05:2021-Security Misconfiguration"
    },
    "ssl_disabled": {
      "patterns": [
        "require_ssl\\s*=\\s*False",
        "SECURE_SSL_REDIRECT\\s*=\\s*False",
        "USE_TLS\\s*=\\s*False",
        "https\\s*=\\s*False"
      ],
      "severity": "high",
      "description": "SSL/TLS not enforced",
      "cwe": "CWE-319",
      "owasp": "A02:2021-Cryptographic Failures"
    }
  },
  "security_best_practices": [
    "Use parameterized queries to prevent SQL injection",
    "Validate and sanitize all user inputs",
    "Implement proper authentication and authorization",
    "Use HTTPS for all communications",
    "Store secrets securely using environment variables or secret management systems",
    "Implement proper error handling without exposing system details",
    "Use secure session management",
    "Apply principle of least privilege",
    "Keep dependencies up to date",
    "Perform regular security audits",
    "Implement CSRF protection for state-changing operations",
    "Use Content Security Policy (CSP) headers",
    "Implement proper logging and monitoring",
    "Validate and sanitize file uploads",
    "Use secure random number generation",
    "Implement rate limiting to prevent abuse"
  ],
  "compliance_standards": {
    "OWASP": {
      "top_10_2021": [
        "A01:2021-Broken Access Control",
        "A02:2021-Cryptographic Failures",
        "A03:2021-Injection",
        "A04:2021-Insecure Design",
        "A05:2021-Security Misconfiguration",
        "A06:2021-Vulnerable and Outdated Components",
        "A07:2021-Identification and Authentication Failures",
        "A08:2021-Software and Data Integrity Failures",
        "A09:2021-Security Logging and Monitoring Failures",
        "A10:2021-Server-Side Request Forgery"
      ]
    },
    "NIST": {
      "framework": [
        "Identify",
        "Protect",
        "Detect",
        "Respond",
        "Recover"
      ]
    }
  },
  "vulnerability_severity": {
    "critical": {
      "cvss_score": "9.0-10.0",
      "examples": ["Remote code execution", "Privilege escalation", "Complete data breach"]
    },
    "high": {
      "cvss_score": "7.0-8.9",
      "examples": ["Data exposure", "Denial of service", "Information disclosure"]
    },
    "medium": {
      "cvss_score": "4.0-6.9",
      "examples": ["Session hijacking", "Cross-site scripting", "Weak authentication"]
    },
    "low": {
      "cvss_score": "0.1-3.9",
      "examples": ["Information leakage", "Configuration issues", "Weak passwords"]
    }
  }
}